---
layout: page
hide: true
title: Fichiers
---
<script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

<style>
html {
 zoom: 0.80;
}
</style>

## Comment accéder aux fichiers ?

Il existe plsuieurs niveaux de gestion des fichiers 
+ stockage mémoire (structure du système de fichier, structure des fichiers,
  inodes)
+ stockage du système (table des descripteurs (processus), table des fichiers
  ouverts, tables des inodes)
  
## Stockage : structure du système de fichiers
+ Boot bloc : block de données qui permet de booter la machine. Flag *bootable*
+ Superbloc : point de montage du système de fichiers, nombre de noeuds alloués
  / libres, liste des noeuds alloués / libres 
+ Table des inodes
+ Blocs de données : contient les données des fichiers, pour un répertoire,
  liste des noms des fichiers
 
![structure](/assets/images/prog_sys/2.png){:class="image about center"}

## Fichiers / inodes

Il y a deux structure en Unix : 
+ le contenu du fichier 
+ les informations sur le fichier (metadata) : inode

Et les informations d'un inode :
+ Type de fichier 
+ Nombre de liens dur (hard link) partageant l'inode
+ Longueur du fichier en octets
+ Identifiant de device
+ Identifiant de l'utilisateur (UID) propriétaire, et son groupe 
+ Date de création, modification
+ Droits d'accès

![inode](/assets/images/prog_sys/3.png){:class="image about center"}

## Gestion des fichiers par le système 

+ Une table des descripteurs de fichiers ouverts/accédés **par processus**
+ Une table des fichiers ouverts pour chaque `open` appelé. Il peut y avoir le
  même fichier plusieurs fois dans cette table. Il en existe une seule pour le
  système. 
+ Une seule table des inodes. Elle gère le nombre d'ouvertures de chaque
  fichier, et stocke les informations des fichiers en mémoire. 

![table](/assets/images/prog_sys/4.png){:class="image about center"}

## Quelques fonctions de base 
+ Manipulation des inodes `stat(), unlink(), chown(), chmod(), mknod(),
  access(), link(), ...`
+ Manipulation des descripteurs de fichier `read(), write(), creat(), open(),
  lseek(), fcntl(), ...`
+ Fonctions de bibliothèque C `fopen(), fclose(), fread(),...`
